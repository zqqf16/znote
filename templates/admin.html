{% extends "admin_base.html" %}
{% block container %}
<div class="row">
  <div class="span12">
    <div class="btn-toolbar">
	  <div class="btn-group">
        <a href="/admin/write" class="btn btn-primary"><i class="icon-pencil icon-white"></i>撰写</a>
      </div>
      <div class="btn-group">
		<a href="#query" class="btn" data-toggle="modal"><i class="icon-cog"></i>过滤</a>
	  </div>
    </div>
    <table class="table table-hover main" data-toggle="tools">
      <tbody>
      {% for article in articles %}
		<tr id="{{article.id}}">
          <td class="span1 hidden-phone"><span class="badge">{{article.view_count}}</span></td>
          <td>
            <a href="/admin/write?id={{article.id}}"><i class="icon-file"></i> {{article.title}}</a>
            <span class="pull-right hide tools-bar hidden-phone">
              {% if article.status == "draft" or article.status == "trash" %}
                <a href="/admin/status?type=publish&id={{article.id}}"><i class="icon-share"></i>发布</a>
              {% end if %}
              <a href="/admin/status?type=page&id={{article.id}}"><i class="icon-bookmark"></i>固定</a>
              <a href="/admin/status?type=trash&id={{article.id}}"><i class="icon-remove"></i>删除</a>
            </span>
          </td>
          <td class="span1 hidden-phone">
          {% if article.category %}
            <span class="label label-info">{{article.category.name}}</span></td>
          {% else %}
            <span class="label">未分类</span></td>
          {% end if %}
		  <td class="span1 hidden-phone">
          {% if article.status == "publish" %}
            <span class="label label-info">{{article.status}}</span></td>
          {% elif article.status == "draft" %}
		    <span class="label">{{article.status}}</span></td>
		  {% elif article.status == "trash" %}
		    <span class="label label-warning">{{article.status}}</span></td>
          {% elif article.status == "page" %}
		    <span class="label label-success">{{article.status}}</span></td>
          {% end if %}
          <td class="span2 hidden-phone">{{article.modified.strftime('%b %d %Y')}}</td> 
        </tr>
        {% end for %}
      </tbody>
    </table>
  </div>
</div>

<div id="query" class="modal hide" tabindex="-1" role="dialog" data-backdrop="false">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3>过滤条件</h3>
  </div>
  <div class="modal-body">
    <form class="form-horizontal" action="/admin" method="get" accept-charset="UTF-8">
	  <div class="control-group">
        <label class="control-label">状态</label>
        <div class="controls">
          <select id="status" name="status">
			<option value="all">全部</option>
            <option value="publish">已发布</option>
            <option value="draft">草稿</option>
            <option value="page">页面</option>
            <option value="trash">回收站</option>
          </select>
        </div>
      </div>
    </ul>
	  <div class="control-group">
        <label class="control-label">分类</label>
        <div class="controls">
          <select id="category" name="category">
		    <option value="all">全部分类</option>
	        {% for c in api.get_categories() %}	 
			<option value={{c.id}}>{{c.name}}</option>
		    {% end for %}
			<option value="none">未分类</option>
	      </select>
        </div>
      </div>
	  <div class="control-group">
        <label class="control-label">排序方式</label>
        <div class="controls">
          <select id="order_by" name="order_by">
		    <option value="default">默认排序</option>
		    <option value="create">最新撰写</option>
			<option value="modify">最新修改</option>
			<option value="view">最多阅读</option>
	      </select>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn" data-dismiss="modal" aria-hidden="true">取消</button>
      <button type="submit" class="btn btn-primary">过滤</button>
    </div>
	<script>
		{% if status %}
		  document.getElementById("status").value="{{status}}";
		{% end if %}
		{% if category %}
		  document.getElementById("category").value="{{category}}";
		{% end if %}
		{% if order_by %}
		  document.getElementById("order_by").value="{{order_by}}";
		{% end if %}
	</script>
  </form>
</div>
{% end %}
