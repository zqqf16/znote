{% extends "admin_base.html" %}
{% block container %}
<div class="row-fluid">
  <div class="span2">
    <ul class="nav nav-pills nav-stacked nav-type" data-toggle="query">
      <li class="active"><a href="publish" data-query="status">已发布</a></li>
      <li><a href="draft" data-query="status">草稿</a></li>
      <li><a href="page" data-query="status">页面</a></li>
      <li><a href="trash" data-query="status">回收站</a></li>
    </ul>
  </div>
  <div class="span10">
    <div class="btn-toolbar">
      <div class="btn-group">
        <a href="#" class="btn btn-primary"><i class="icon-pencil icon-white"></i>撰写</a>
      </div>
      <div class="btn-group pull-right">
        <button class="btn dropdown-toggle" data-toggle="dropdown">排序方式 <span class="caret"></span></button>
        <ul class="dropdown-menu" data-toggle="query">
          <li><a href="create" data-query="order_by">最新撰写</a></li>
          <li><a href="modify" data-query="order_by">最新修改</a></li>
          <li><a href="view" data-query="order_by">最多访问</a></li>
        </ul>
      </div>
      <div class="btn-group pull-right">
        <button class="btn dropdown-toggle" data-toggle="dropdown">所有分类 <span class="caret"></span></button>
        <ul class="dropdown-menu" data-toggle="query">
          {% for c in api.get_categories() %}
          <li><a href="{{c.id}}" data-query="category">{{c.name}}</a></li>
          {% end for %}
          <li class="divider"></li>
          <li><a href="none" data-query="category">未分类</a></li>
          {% if category != 'all' %}
            <li class="divider"></li>
            <li><a href="all" data-query="category">全部分类</a></li>
          {% end if %}
        </ul>
      </div>
    </div>
    <table class="table table-hover main" data-toggle="tools">
      <tbody>
      {% for article in articles %}
        <tr id="{{article.id}}"> 
          <td class="span1"><span class="badge">{{article.view_count}}</span></td>
          <td>
            <a href="/admin/write?id={{article.id}}"><i class="icon-file"></i> {{article.title}}</a>
            <span class="pull-right hide tools-bar">
              {% if article.status == "draft" or article.status == "trash" %}
                <a href="/admin/option?id={{article.id}}"><i class="icon-share"></i> 发布</a>
              {% end if %}
              <a href="/admin/write?id={{article.id}}"><i class="icon-edit"></i> 编辑</a>
              <a href="/admin/delete?id={{article.id}}"><i class="icon-remove"></i> 删除</a>
            </span>
          </td>
          <td class="span1">
          {% if article.category %}
            <span class="label label-info">{{article.category.name}}</span></td>
          {% else %}
            <span class="label">未分类</span></td>
          {% end if %}
          <td class="span2">{{article.modified.strftime('%b %d %Y')}}</td> 
        </tr>
        {% end for %}
      </tbody>
    </table>
  </div>
</div>
{% end %}
